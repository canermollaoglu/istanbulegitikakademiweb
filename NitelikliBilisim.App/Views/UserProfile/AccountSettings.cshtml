@model NitelikliBilisim.Core.ViewModels.Main.Profile.MyAccountSettingsGetVm
@using NitelikliBilisim.App.Utility
@{
    ViewData["Title"] = "Hesap Ayarları";
    Layout = "~/Views/Shared/_LayoutHesap.cshtml";
    var avatarPath = "";
    if (string.IsNullOrEmpty(Model.GeneralInformation.AvatarPath))
    {
        avatarPath = "../../img/nb_letter_logo_sm.png";
    }
    else
    {
        avatarPath = StorageService.BlobUrl + Model.GeneralInformation.AvatarPath;
    }
}

<section class="account account--dashboard">
    <div class="account-mobile__top">
        <a asp-controller="UserProfile" asp-action="MyMenu" class="account-mobile__prev">
            <span class="icon-outer">
                <svg class="icon">
                    <use xlink:href="../../assets/img/icons.svg#icon-arrow"></use>
                </svg>
            </span>
        </a>
        <span class="account-mobile__txt">
            AYARLAR
        </span>
    </div>
    <div class="container">
        <div class="account__wrp">
            @await Component.InvokeAsync("MyAccountSidebar", AccountSideBarPageNames.Settings)
            <div class="account-content">
                <div class="account-detail">
                    <div class="account-detail__wrp">
                        <div class="account-detail__title">
                            AYARLAR
                        </div>
                        @if (TempData["Success"] != null)
                        {
                            <div class="success-messages" style="display: block;">
                                @TempData["Success"]
                            </div>
                        }

                        <div class="accordion accordion--loft">
                            <div class="accordion__item selected active">
                                <div class="accordion__header">
                                    <span class="icon-outer accordion__icon">
                                    </span>
                                    Kullanıcı Bilgileri
                                </div>
                                <div class="accordion__content">
                                    <div class="js-calc-accordion-height">
                                        <div class="accordion__forms">
                                            <form method="post" action="/kullanici-bilgileri-guncelle" enctype="multipart/form-data">
                                                @Html.AntiForgeryToken()
                                                <div class="input__column-2">
                                                    <div class="input__outer no-icon icon-password">
                                                        <div class="input__title">Eski Şifre</div>
                                                        <input type="password" name="OldPassword" class="input input--bordered input--fw input--noshadow js-password"
                                                               placeholder="Eski Şifrenizi Giriniz">
                                                        <span class="icon-outer js-show-password">
                                                            <svg class="icon">
                                                                <use xlink:href="../../assets/img/icons.svg#icon-eye"></use>
                                                            </svg>
                                                        </span>
                                                    </div>
                                                    <div class="input__outer no-icon icon-password">
                                                        <div class="input__title">Yeni Şifre</div>
                                                        <input type="password" name="NewPassword" class="input input--bordered input--fw input--noshadow js-password"
                                                               placeholder="Yeni Şifrenizi Giriniz">
                                                        <span class="icon-outer js-show-password">
                                                            <svg class="icon">
                                                                <use xlink:href="../../assets/img/icons.svg#icon-eye"></use>
                                                            </svg>
                                                        </span>
                                                    </div>
                                                    <div class="input__outer no-icon icon-password">
                                                        <div class="input__title">Yeni Şifre Tekrar</div>
                                                        <input type="password" name="ConfirmNewPassword" class="input input--bordered input--fw input--noshadow js-password"
                                                               placeholder="Yeni Şifrenizi Tekrar Giriniz">
                                                        <span class="icon-outer js-show-password">
                                                            <svg class="icon">
                                                                <use xlink:href="../../assets/img/icons.svg#icon-eye"></use>
                                                            </svg>
                                                        </span>
                                                    </div>
                                                </div>
                                                @*<div class="input__outer no-icon">
                                                    <div class="input__title">Profil Resmi</div>
                                                    <div class="input__select-image">
                                                        <div class="input__select-image-img">
                                                            <input type="image" id="accountChangeImg" src="@avatarPath">
                                                            <input type="file" id="accountSettingsImg" name="ProfileImage" style="display: none;" />
                                                        </div>
                                                        <div class="input__select-image-button">
                                                            <a class="button button-fw js-change-img">
                                                                <span class="button-txt">
                                                                    Resmi Değiştir
                                                                </span>
                                                            </a>
                                                        </div>
                                                        <div class="input__select-image-txt">
                                                            Maksimum boyut 1 MB.<br>
                                                            JPG, GIF veya PNG
                                                        </div>
                                                    </div>
                                                </div>*@
                                                <div class="account-detail__setting-btn">
                                                    <button type="submit" class="button">
                                                        Değişiklikleri Kaydet
                                                    </button>
                                                </div>
                                            </form>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="accordion__item">
                                <div class="accordion__header">
                                    <span class="icon-outer accordion__icon">
                                    </span>
                                    Kişisel Bilgiler
                                </div>
                                <div class="accordion__content">
                                    <div class="js-calc-accordion-height">
                                        <div class="accordion__forms">
                                            <form action="/kullanici-kisisel-bilgiler-guncelle" method="post">
                                                @Html.AntiForgeryToken()
                                                <div class="input__column-2">
                                                    <div class="input__outer no-icon">
                                                        <div class="input__title">Adınız Soyadınız</div>
                                                        <input type="text" class="input input--bordered input--fw input--noshadow" readonly
                                                               placeholder="Ad ve Soyadınızı Giriniz" value="@Model.GeneralInformation.Name @Model.GeneralInformation.Surname">
                                                    </div>
                                                    <div class="input__outer bordered-select">
                                                        <div class="select-subject no-icon">
                                                            <div class="input__title">Cinsiyetiniz</div>
                                                            <select name="Gender" class="js-cinsiyet-select">
                                                                <option value="" selected hidden disabled>Cinsiyetinizi Seçiniz</option>
                                                                @foreach (var gender in Model.Genders)
                                                                {
                                                                    if (gender.Key == (int)Model.GeneralInformation.Gender)
                                                                    {
                                                                        <option value="@gender.Key" selected>@gender.Value</option>
                                                                    }
                                                                    else
                                                                    {
                                                                        <option value="@gender.Key">@gender.Value</option>
                                                                    }

                                                                }
                                                            </select>
                                                        </div>
                                                    </div>
                                                    <div class="input__outer no-icon datepicker--fw icon-datepicker">
                                                        <div class="input__title">Doğum Tarihiniz</div>
                                                        <input type="text" name="BirthDate" class="input input--bordered input--fw input--noshadow js-datepicker"
                                                               value="@(Model.GeneralInformation.DateOfBirth.HasValue?Model.GeneralInformation.DateOfBirth.Value.ToString("dd/MM/yyyy"):"")" placeholder="Doğum Tarihiniz">
                                                        <span class="icon-outer">
                                                            <svg class="icon">
                                                                <use xlink:href="../../assets/img/icons.svg#icon-date"></use>
                                                            </svg>
                                                        </span>
                                                    </div>
                                                </div>
                                                <div class="input__column-2">
                                                    <div class="input__outer bordered-select input-mb-0">
                                                        <div class="select-subject no-icon">
                                                            <div class="input__title">Son Mezun Olduğunuz Okul</div>
                                                            <select name="LastGraduatedSchoolId" class="js-okul-select">
                                                                <option value="" hidden disabled selected>Okulunuzu Seçiniz</option>
                                                                @foreach (var university in Model.Universities.OrderBy(x => x.Name))
                                                                {
                                                                    if (university.Id == Model.GeneralInformation.LastGraduatedSchoolId)
                                                                    {
                                                                        <option value="@university.Id" selected>@university.Name</option>
                                                                    }
                                                                    else
                                                                    {
                                                                        <option value="@university.Id">@university.Name</option>
                                                                    }

                                                                }
                                                            </select>
                                                        </div>
                                                    </div>
                                                    <div class="input__outer bordered-select input-mb-0">
                                                        <div class="select-subject no-icon">
                                                            <div class="input__title">Mesleğiniz / Ünvanınız</div>
                                                            <select name="Job" class="js-meslek-select">
                                                                <option value="" selected hidden disabled>Mesleğinizi Seçiniz</option>
                                                                @foreach (var job in Model.Jobs)
                                                                {
                                                                    if ((int)Model.GeneralInformation.Job == job.Key)
                                                                    {
                                                                        <option value="@job.Key" selected>@job.Value</option>
                                                                    }
                                                                    else
                                                                    {
                                                                        <option value="@job.Key">@job.Value</option>
                                                                    }

                                                                }
                                                            </select>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="account-detail__setting-btn">
                                                    <button type="submit" class="button">
                                                        Değişiklikleri Kaydet
                                                    </button>
                                                </div>
                                            </form>

                                        </div>
                                    </div>
                                </div>
                            </div>
                            @if (Model.GeneralInformation.IsNbuyStudent && Model.GeneralInformation.NbuyInformation!=null)
                            {
                            <div class="accordion__item">
                                <div class="accordion__header">
                                    <span class="icon-outer accordion__icon">
                                    </span>
                                    NBUY EĞİTİMLERİNİZ
                                </div>
                                <div class="accordion__content">
                                    <div class="js-calc-accordion-height">
                                        <div class="accordion__forms">
                                            <form method="post" action="/nbuy-egitim-bilgileri-guncelle">
                                                @Html.AntiForgeryToken()
                                            <div class="input__column-2">
                                                <div class="input__outer bordered-select input-mb-0">
                                                    <div class="select-subject no-icon">
                                                        <div class="input__title">Eğitim Merkezi</div>
                                                        <select name="EducationCenter" class="js-egitim-merkezi-select">
                                                            <option value="" hidden disabled>Eğitim Merkezini Seçiniz</option>
                                                            @foreach (var educationCenter in Model.EducationCenters)
                                                            {
                                                                if ((int)Model.GeneralInformation.NbuyInformation.EducationCenter == educationCenter.Key)
                                                                {
                                                                    <option value="@educationCenter.Key" selected>@educationCenter.Value</option>
                                                                }
                                                                else
                                                                {
                                                                    <option value="@educationCenter.Key">@educationCenter.Value</option>
                                                                }
                                                            }
                                                        </select>
                                                    </div>
                                                </div>
                                                <div class="input__outer no-icon datepicker--fw icon-datepicker input-mb-0">
                                                    <div class="input__title">Eğitim Başlangıç Tarihi</div>
                                                    <input type="text" name="StartAt" class="input input--bordered input--fw input--noshadow js-datepicker"
                                                           value="@Model.GeneralInformation.NbuyInformation.StartAt.ToString("dd.MM.yyyy")" placeholder="Eğitim Başlangıç Tarihini Seçiniz">
                                                    <span class="icon-outer">
                                                        <svg class="icon">
                                                            <use xlink:href="../../assets/img/icons.svg#icon-date"></use>
                                                        </svg>
                                                    </span>
                                                </div>
                                                <div class="input__outer bordered-select input-mb-0">
                                                    <div class="select-subject no-icon">
                                                        <div class="input__title">Eğitim Türü</div>
                                                        <select name="EducationCategoryId" class="js-education-type-select">
                                                            <option value="" hidden disabled>Eğitim Türünü Seçiniz</option>
                                                            @foreach (var category in Model.EducationCategories)
                                                            {
                                                                if (Model.GeneralInformation.NbuyInformation.CategoryId == category.Key)
                                                                {
                                                                    <option value="@category.Key" selected>@category.Value</option>
                                                                }
                                                                else
                                                                {
                                                                    <option value="@category.Key">@category.Value</option>
                                                                }

                                                            }
                                                        </select>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="account-detail__setting-btn">
                                                <button type="submit" class="button">
                                                    Değişiklikleri Kaydet
                                                </button>
                                            </div>
                                            </form>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            }
                            <div class="accordion__item">
                                <div class="accordion__header">
                                    <span class="icon-outer accordion__icon">
                                    </span>
                                    iletişim bilgileri
                                </div>
                                <div class="accordion__content">
                                    <div class="js-calc-accordion-height">
                                        <div class="accordion__forms">
                                            <form id="contact-info-form" action="/kullanici-iletisim-bilgisi-guncelle" method="post">
                                                @Html.AntiForgeryToken()
                                                <div class="input__column-2">
                                                    <div class="input__outer input--phone f-column">
                                                        <div class="input__title">Telefon Numaranız</div>
                                                        <div>
                                                            <input type="text" name="PhoneNumber" id="inputPhoneNumber"
                                                                   class="input input--bordered input--fw input--noshadow inputPhoneNumber"
                                                                   value="@Model.GeneralInformation.Phone"
                                                                   placeholder="___-__-__">
                                                        </div>
                                                    </div>
                                                    <div class="input__outer no-icon">
                                                        <div class="input__title">E-posta Adresiniz</div>
                                                        <input type="text" class="input input--bordered input--fw input--noshadow"
                                                               placeholder="E-posta Adresinizi Giriniz" value="@Model.GeneralInformation.Email">
                                                    </div>
                                                    <div class="input__outer bordered-select">
                                                        <div class="select-subject no-icon">
                                                            <div class="input__title">Şehir</div>
                                                            <select name="CityId" class="js-sehir-select">
                                                                <option value="" hidden disabled>Şehir Seçiniz</option>
                                                                @foreach (var city in Model.Cities)
                                                                {
                                                                    if (city.Id == Model.GeneralInformation.CityId)
                                                                    {
                                                                        <option value="@city.Id" selected>@city.Name</option>
                                                                    }
                                                                    else
                                                                    {
                                                                        <option value="@city.Id">@city.Name</option>
                                                                    }

                                                                }
                                                            </select>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="input__column-2">
                                                    <div class="input__outer no-icon input__link input-mb-0">
                                                        <div class="input__title">Web Siteniz</div>
                                                        <div class="input__link-inner">
                                                            <span>http://</span>
                                                            <input type="text" name="Website" class="input input--bordered input--fw input--noshadow"
                                                                   placeholder="Website Adresinizi Giriniz" value="@Model.GeneralInformation.WebSite">
                                                        </div>
                                                    </div>
                                                    <div class="input__outer no-icon input__link input-mb-0">
                                                        <div class="input__title">Linkedin Profiliniz</div>
                                                        <div class="input__link-inner">
                                                            <span>linkedin.com/</span>
                                                            <input type="text" name="LinkedIn" class="input input--bordered input--fw input--noshadow"
                                                                   placeholder="Linkedin Adresinizi Giriniz" value="@Model.GeneralInformation.LinkedIn">
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="account-detail__setting-btn">
                                                    <button type="submit" class="button">
                                                        Değişiklikleri Kaydet
                                                    </button>
                                                </div>
                                            </form>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="accordion__item">
                                <div class="accordion__header">
                                    <span class="icon-outer accordion__icon">
                                    </span>
                                    Adres bilgileri
                                </div>
                                <div class="accordion__content">
                                    <div class="js-calc-accordion-height">
                                        <div class="accordion__forms">
                                            <div class="address-wrp">
                                                <form method="post" action="/default-adres-guncelle">
                                                    @Html.AntiForgeryToken()
                                                    <input type="hidden" name="defaultAddressId" id="input-default-address-id"/>
                                                    @if (Model.Addresses.Count == 0)
                                                    {
                                                        @*<div class="address-item">
                <div class="address-button js-select-address">
                    <span class="address-button-radio"></span>
                </div>
                <div class="address-cnt js-select-address">
                    <div class="address-title">
                        Fatura Adresim
                    </div>
                    <div class="address-txt">

                    </div>
                </div>
            </div>
            <div class="address-input-wrp">
                <div class="input__column-flex">
                    <div class="input__outer bordered-select">
                        <div class="select-subject no-icon">
                            <div class="input__title">Şehir</div>
                            <select class="js-adres-sehir-select">
                                <option value="" hidden disabled>Şehir</option>
                                @foreach (var city in Model.Cities)
                                {
                                    <option value="@city.Id">@city.Name</option>
                                }
                            </select>
                        </div>
                    </div>
                    <div class="input__outer bordered-select input-mb-0">
                        <div class="select-subject no-icon">
                            <div class="input__title">İlçe</div>
                            <select class="js-adres-ilce-select">
                                <option value="" hidden disabled>İlçe</option>
                            </select>
                        </div>
                    </div>
                </div>
                <div class="input__outer input--textarea no-icon">
                    <div class="input__title">Açık Adresiniz</div>
                    <textarea name="Content"
                              class="input input--fw input--bordered input--noshadow h-150"
                              placeholder="Adresinizin tamamını buraya yazınız"></textarea>
                </div>
            </div>*@
                                                    }
                                                    @foreach (var address in Model.Addresses)
                                                    {
                                                        <div class="address-item @(address.IsDefaultAddress?"selected":"")">
                                                            <div class="address-button js-select-address-account" data-id="@address.Id">
                                                                <span class="address-button-radio"></span>
                                                            </div>
                                                            <div class="address-cnt js-select-address-account" data-id="@address.Id">
                                                                <div class="address-title">
                                                                    @address.Title
                                                                </div>
                                                                <div class="address-txt">
                                                                    @address.Content <br> @address.State.Name @address.City.Name
                                                                </div>
                                                            </div>
                                                        </div>
                                                    }
                                                    <div class="account-detail__setting-btn">
                                                        <button type="submit" class="button">
                                                            Değişiklikleri Kaydet
                                                        </button>
                                                    </div>
                                                </form>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

@section postScripts{
    <script type="text/javascript">
        

        $('body').on('click', '.js-select-address-account', function () {
            var aId = $(this).data("id");
            $("#input-default-address-id").val(aId);
            if (
                $(this)
                    .parent()
                    .hasClass('selected')
            ) {
                $(this)
                    .parent()
                    .removeClass('selected');
            } else {
                $('.address-item').removeClass('selected');
                $(this)
                    .parent()
                    .addClass('selected');
            }
            if ($('.address-item').hasClass('selected')) {
                $('.js-new-address').removeClass('active');
                $('.js-new-address')
                    .find('.accordion__content')
                    .css('height', '0');
            } else {
                $('.js-new-address').removeClass('disabled');
            }
        });
    </script>
}